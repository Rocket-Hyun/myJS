<!DOCTYPE HTML>
<html>
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<h1>Hi</h1>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="http://underscorejs.org/underscore-min.js"></script>
<script src="http://backbonejs.org/backbone-min.js"></script>
<script>
    // Create Model
    var Todo = Backbone.Model.extend({
        defaults: {
            completed: false
        },

        initialize: function(){
            console.log('This model has been initialized.');

            // change detection added
            this.on("change:title", function(){
                console.log('WARNING! TITLE CHANGED!!');
            });

            // check valid
            this.on("invalid", function(model, error){
                console.log(model, " has error:" + error);
            });
        },

        validate: function(attributes){
            if(attributes.title === undefined) {
                return "YOU NEED TITLE for your TODO.";
            }
        }
    });

    // instanciate model
    var todo1 = new Todo();
    // Get whole data property
    // console.log(JSON.stringify(todo1));

    // Get specific data property
    // console.log(todo1.get('title'));

    // Get whole data by JSON
    // var todo1Attributes = todo1.toJSON();
    // console.log(todo1Attributes);

    // Set data property
    // Second argument is optional
    todo1.set({
        "completed": true
    }, {validate: true});
    //
    // console.log(JSON.stringify(todo1));
    //
    todo1.set("title", "something");
    // console.log(JSON.stringify(todo1));


    // var todo2 = new Todo({
    //     title: "Check the attributes of both model instances in the console.",
    //     completed: true
    // });
    //
    // // console.log(JSON.stringify(todo2));
    // console.log(todo2.get('completed'));

    // Create View
    var TodoView = Backbone.View.extend({
        tagName: 'li',
        className: 'todoItem',
        // id: 'todo',

        // todoTpl: _.template("An example template"),

        events: {
           'dbclick label': 'edit',
           'keypress .edit': 'updateOnEnter',
           'blur .edit': 'close'
        },

        // Rerendering
        render: function() {
            this.$el.html( this.todoTpl( this.model.attributes ));
            this.input = this.$('.edit');
            return this;
        },

        edit: function() {
            console.log("edit mode!");
        },

        close: function() {
            console.log("close!");
        },

        updateOnEnter: function(e) {
            console.log("update!");
        }
    });

    var todoView = new TodoView();

    console.log(todoView.el);
</script>
</body>
</html>